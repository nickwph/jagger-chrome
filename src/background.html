<script type="text/javascript" src="database.js"></script>
<script type="text/javascript" src="injector.js"></script>
<script>
    
    database.open();
    database.dropTable();
    database.createTable();
    database.addScript("/en.wikipedia.org/", "alert('aaa');", true);

    chrome.tabs.onUpdated.addListener(function(tabId, info, tab) {
    
        //run when the page finished loading, otherwise it fires twice
        if (info.status == "complete") {
            database.getMatchedScript(tab.url, function(data) {
                injector.injectScript(tabId, data.script);
            }); 
        }
    });

        	
</script>